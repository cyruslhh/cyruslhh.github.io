<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CS180 Project 4 | Cyrus Hung </title> <meta name="author" content="Cyrus Hung"> <meta name="description" content="Image Warp + Mosaic"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cyruslhh.github.io/projects/CS180_project_4/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Cyrus</span> Hung </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Me </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">CS180 </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/projects/CS180_project_1/">Project 1</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/CS180_project_2/">Project 2</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/CS180_project_3/">Project 3</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/CS180_project_4/">Project 4</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">CS180 Project 4</h1> <p class="post-description">Image Warp + Mosaic</p> </header> <article> <h2 id="task-1-taking-pictures-rectification">Task 1: Taking Pictures (Rectification)</h2> <p>Our first task is to take a couple of pictures of rectangle-shaped objects from different angles, and try to rectify them. I chose 3 different pictures below: a vinyl cd, a no-smoking sign, and finally a rectangular window. I’m particularly interested in the window as the effect of rectifying gives the illusion that we’re standing right in front of the object thus making it rectangular, but we obviously can’t see straight out the window as our view is from the side, so what would the effect look like in the finished image?</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/1_1-480.webp 480w,/assets/img/CS180/Project_4/1_1-800.webp 800w,/assets/img/CS180/Project_4/1_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/1_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/2_1-480.webp 480w,/assets/img/CS180/Project_4/2_1-800.webp 800w,/assets/img/CS180/Project_4/2_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/2_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/3_1-480.webp 480w,/assets/img/CS180/Project_4/3_1-800.webp 800w,/assets/img/CS180/Project_4/3_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/3_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="task-2-recover-homographies">Task 2: Recover Homographies</h2> <p>Next, we need to recover a homography to transform the images. In our first problem of rectification, the idea is simple: Label the 4 corners of the images, select 4 additional points to create a rectangle (roughly the same shape as the original object), and recover a homography from the image’s 4 corners to the rectangle.</p> <p>Here are the pairs of points that were chosen for the images:</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/1_3-480.webp 480w,/assets/img/CS180/Project_4/1_3-800.webp 800w,/assets/img/CS180/Project_4/1_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/1_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/1_4-480.webp 480w,/assets/img/CS180/Project_4/1_4-800.webp 800w,/assets/img/CS180/Project_4/1_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/1_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/2_3-480.webp 480w,/assets/img/CS180/Project_4/2_3-800.webp 800w,/assets/img/CS180/Project_4/2_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/2_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/2_4-480.webp 480w,/assets/img/CS180/Project_4/2_4-800.webp 800w,/assets/img/CS180/Project_4/2_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/2_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/3_3-480.webp 480w,/assets/img/CS180/Project_4/3_3-800.webp 800w,/assets/img/CS180/Project_4/3_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/3_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/3_4-480.webp 480w,/assets/img/CS180/Project_4/3_4-800.webp 800w,/assets/img/CS180/Project_4/3_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/3_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>After setting the points, we set up the equation p’=Hp, where p’ is our destination points and p is our source points, and solve for H. In this case, since we have 4 points, there is only one possible H that can satisfy the equation. For mosaics though, we’ll choose more points for stability, so we’ll make an overdetermined system and use least squares (or SVD) in order to find the best solution.</p> <p>To solve for H, we’ll use the equation we learned in lecture, but sing SVD instead:</p> \[A = \begin{bmatrix} x_1 &amp; y_1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; -x_2 x_1 &amp; -x_2 y_1 &amp; -x_2 \\ 0 &amp; 0 &amp; 0 &amp; x_1 &amp; y_1 &amp; 1 &amp; -y_2 x_1 &amp; -y_2 y_1 &amp; -y_2 \end{bmatrix}\] <p>By then using SVD, decomposing the matrix into the form:</p> \[A = U S V^T\] <p>The least squares solution will be in \(V^T\), which has 9 variables</p> <p>We reshape this into a 3x3 matrix, and then by dividing the entire matrix by the last variable (I), we get an H of the form</p> \[H = \begin{bmatrix} h_1 &amp; h_2 &amp; h_3 \\ h_4 &amp; h_5 &amp; h_6 \\ h_7 &amp; h_8 &amp; 1 \end{bmatrix}\] <p>Now, if we plug in a particular point (with a one appended to it) from the image, the resulting point will look like:</p> \[\begin{bmatrix} wx_2 \\ wy_2 \\ w \end{bmatrix} = H \begin{bmatrix} x_1 \\ y_1 \\ 1 \end{bmatrix}\] <p>Dividing the resulting point by w yields \(x_2\) and \(y_2\), giving our new coordinates.</p> <h2 id="task-3-warping-the-image-image-rectification">Task 3: Warping the image (Image Rectification)</h2> <p>Now that we have the homography, it seems trivial to simply pipe each point of the original image through the homography to get the new coordinates of that pixel, giving us our result. However, this is forward warping, and as we’ve seen in project 3 this results in tons of holes. Therefore, we need to use inverse warping instead. Thus, the algorithm looks very similar with our triangle warping function from Project 3:</p> <ol> <li>Find the homography H from src_points to dst_points</li> <li>Take the inverse, yielding H’</li> <li>Determine the dimensions of the resulting image by warping the 4 corners of the src image through H. Shift the entire image if there are any negative values so that the negative values become 0.</li> <li>For each point in the resulting image, apply H’ and interpolate to find the src image’s corresponding pixel value, and apply it.</li> </ol> <p>We can also vectorize 4 by making a 2D matrix of all the points in our result image, yielding a way faster result. We’ll ignore any points that are outside of the convex hull of the warped bounding box.</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/1_1-480.webp 480w,/assets/img/CS180/Project_4/1_1-800.webp 800w,/assets/img/CS180/Project_4/1_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/1_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/1_2-480.webp 480w,/assets/img/CS180/Project_4/1_2-800.webp 800w,/assets/img/CS180/Project_4/1_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/1_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/2_1-480.webp 480w,/assets/img/CS180/Project_4/2_1-800.webp 800w,/assets/img/CS180/Project_4/2_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/2_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/2_2-480.webp 480w,/assets/img/CS180/Project_4/2_2-800.webp 800w,/assets/img/CS180/Project_4/2_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/2_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/3_1-480.webp 480w,/assets/img/CS180/Project_4/3_1-800.webp 800w,/assets/img/CS180/Project_4/3_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/3_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/3_2-480.webp 480w,/assets/img/CS180/Project_4/3_2-800.webp 800w,/assets/img/CS180/Project_4/3_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/3_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The results surprised me, giving us the illusion that we’re looking at the images from a new point of view. The window one shocked me the most. We weren’t able to see more of the scenery outside of the window (of course), but a shift in the perspective and perceived distance from the window warped the window to a rectangular shape.</p> <h2 id="task-4-image-stitching-manual">Task 4: Image Stitching (Manual)</h2> <p>Lastly, we come to image stitching. At a high level the steps are to:</p> <ol> <li>Take a pair of images with significant overlap. Label common features/points between the two images</li> <li>Create a homography to map the second image’s points to the corresponding points in the first image</li> <li>Warp the second image using what we created in Task 3</li> <li>Align the images together, and blend.</li> </ol> <p>First, let’s take a couple of pictures:</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_1-480.webp 480w,/assets/img/CS180/Project_4/4_1-800.webp 800w,/assets/img/CS180/Project_4/4_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_2-480.webp 480w,/assets/img/CS180/Project_4/4_2-800.webp 800w,/assets/img/CS180/Project_4/4_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_1-480.webp 480w,/assets/img/CS180/Project_4/5_1-800.webp 800w,/assets/img/CS180/Project_4/5_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_3-480.webp 480w,/assets/img/CS180/Project_4/5_3-800.webp 800w,/assets/img/CS180/Project_4/5_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Next, let’s label some correspondences between them manually.</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_6-480.webp 480w,/assets/img/CS180/Project_4/4_6-800.webp 800w,/assets/img/CS180/Project_4/4_6-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Working on the project </div> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_7-480.webp 480w,/assets/img/CS180/Project_4/4_7-800.webp 800w,/assets/img/CS180/Project_4/4_7-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Working on the project side view </div> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_6-480.webp 480w,/assets/img/CS180/Project_4/5_6-800.webp 800w,/assets/img/CS180/Project_4/5_6-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Balcony </div> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_7-480.webp 480w,/assets/img/CS180/Project_4/5_7-800.webp 800w,/assets/img/CS180/Project_4/5_7-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Balcony side view </div> </div> </div> <p>Then, we warp the second image using the homography recovered</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_1-480.webp 480w,/assets/img/CS180/Project_4/5_1-800.webp 800w,/assets/img/CS180/Project_4/5_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_2-480.webp 480w,/assets/img/CS180/Project_4/5_2-800.webp 800w,/assets/img/CS180/Project_4/5_2-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_1-480.webp 480w,/assets/img/CS180/Project_4/4_1-800.webp 800w,/assets/img/CS180/Project_4/4_1-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_3-480.webp 480w,/assets/img/CS180/Project_4/4_3-800.webp 800w,/assets/img/CS180/Project_4/4_3-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man x" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Now, we need to align. Unfortunately if we stacked one image atop the other, the borders will be really obvious. Therefore, we need some form of blending. The algorithm I came up with is:</p> <ol> <li>Recover x_shift and y_shift from inverse warping. We found this when applied H to the bounding box of image 2 while inverse warping.</li> <li>Reshape image 1 so that the height of the image is the same as image 2, and apply y_shift so that they are aligned in the y_axis.</li> <li>Apply x_shift to image 2 so that the x_axis is aligned.</li> <li>Find the overlapping image (all points with x value between x_shift and im1.width)</li> <li>Fill in the non-overlapping areas with image 1 on the left and image 2 on the right.</li> <li>In the overlapping area, use an alpha value that begins at 0 at the left side and increases to 1 on the right side. Use a weighted sum of image 1 and image 2, multiplying image 1’s pixel values by (1 - alpha) and image 2’s by alpha.</li> </ol> <p>This results in the following images:</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_4-480.webp 480w,/assets/img/CS180/Project_4/4_4-800.webp 800w,/assets/img/CS180/Project_4/4_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Working on the project finished </div> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_4-480.webp 480w,/assets/img/CS180/Project_4/5_4-800.webp 800w,/assets/img/CS180/Project_4/5_4-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> balcony finished </div> </div> </div> <p>One issue is the strange triangular gray areas in the overlapping region. We can fix this by using a for loop to detect points in the overlapping region where one image is out of bounds. If that’s the case, use only the pixel values from the image that isn’t out of bounds.</p> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/4_5-480.webp 480w,/assets/img/CS180/Project_4/4_5-800.webp 800w,/assets/img/CS180/Project_4/4_5-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/4_5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Working on the project improved </div> </div> </div> <div class="row align-items-end"> <div class="col-sm mt-3 mt-md-0" style="height: 50%;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CS180/Project_4/5_5-480.webp 480w,/assets/img/CS180/Project_4/5_5-800.webp 800w,/assets/img/CS180/Project_4/5_5-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/CS180/Project_4/5_5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="camera man" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Balcony improved </div> </div> </div> <p>Overall, this project was immensely satisfying and it was fun taking some of the functions and logic that was written in project 3 and reusing it. As a kid I always thought it’ll be easy to make panoramic shots - just blend many images together! But this project proved otherwise, and showed that there are many optimizations and changes needed before it looks decent.</p> <p>Another key learning from this was the importance of good labeling. I tried only using 4-5 points for the balcony picture and that resulted in disaster, where the roads were obviously not lined up. I realized it’s because I was mostly using features at the top of the image and neglected points at the bottom. I was surprised that adding twice the number of points and adding more points at the bottom of the image made the stitching far far better.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Cyrus Hung. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-me",title:"Me",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-projects",title:"projects",description:"A growing collection of your cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"Edit the `_data/repositories.yml` and change the `github_users` and `github_repos` lists to include your own GitHub profile and repositories.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"This is a description of the page. You can modify it in '_pages/cv.md'. You can also change or remove the top pdf download button.",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-teaching",title:"teaching",description:"Materials for courses you taught. Replace this text with your description.",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"dropdown-project-1",title:"Project 1",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-project-2",title:"Project 2",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-project-3",title:"Project 3",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-project-4",title:"Project 4",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"post-google-gemini-updates-flash-1-5-gemma-2-and-project-astra",title:'Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra <svg width="1.2rem" height="1.2rem" top=".5rem" viewbox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"We\u2019re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.",section:"Posts",handler:()=>{window.open("https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/","_blank")}},{id:"post-displaying-external-posts-on-your-al-folio-blog",title:'Displaying External Posts on Your al-folio Blog <svg width="1.2rem" height="1.2rem" top=".5rem" viewbox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"",section:"Posts",handler:()=>{window.open("https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2","_blank")}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-cs180-project-1",title:"CS180 Project 1",description:"Colorizing the Prokudin-Gorskii photo collection",section:"Projects",handler:()=>{window.location.href="/projects/CS180_project_1/"}},{id:"projects-cs180-project-2",title:"CS180 Project 2",description:"Fun with Filters and Frequencies",section:"Projects",handler:()=>{window.location.href="/projects/CS180_project_2/"}},{id:"projects-cs180-project-3",title:"CS180 Project 3",description:"Face Morphing and Modelling a Photo Collection",section:"Projects",handler:()=>{window.location.href="/projects/CS180_project_3/"}},{id:"projects-cs180-project-4",title:"CS180 Project 4",description:"Image Warp + Mosaic",section:"Projects",handler:()=>{window.location.href="/projects/CS180_project_4/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%6C%68%63%79%72%75%73%68%75%6E%67@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>